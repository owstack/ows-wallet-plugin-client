var qrcode=function(){function qrPolynomial(num,shift){if(void 0===num.length)throw new Error(num.length+"/"+shift);var _num=function(){for(var offset=0;offset<num.length&&0==num[offset];)offset+=1;for(var _num=new Array(num.length-offset+shift),i=0;i<num.length-offset;i+=1)_num[i]=num[i+offset];return _num}(),_this={};return _this.getAt=function(index){return _num[index]},_this.getLength=function(){return _num.length},_this.multiply=function(e){for(var num=new Array(_this.getLength()+e.getLength()-1),i=0;i<_this.getLength();i+=1)for(var j=0;j<e.getLength();j+=1)num[i+j]^=QRMath.gexp(QRMath.glog(_this.getAt(i))+QRMath.glog(e.getAt(j)));return qrPolynomial(num,0)},_this.mod=function(e){if(_this.getLength()-e.getLength()<0)return _this;for(var ratio=QRMath.glog(_this.getAt(0))-QRMath.glog(e.getAt(0)),num=new Array(_this.getLength()),i=0;i<_this.getLength();i+=1)num[i]=_this.getAt(i);for(var i=0;i<e.getLength();i+=1)num[i]^=QRMath.gexp(QRMath.glog(e.getAt(i))+ratio);return qrPolynomial(num,0).mod(e)},_this}var qrcode=function(typeNumber,errorCorrectLevel){var _typeNumber=typeNumber,_errorCorrectLevel=QRErrorCorrectLevel[errorCorrectLevel],_modules=null,_moduleCount=0,_dataCache=null,_dataList=new Array,_this={},makeImpl=function(test,maskPattern){_moduleCount=4*_typeNumber+17,_modules=function(moduleCount){for(var modules=new Array(moduleCount),row=0;row<moduleCount;row+=1){modules[row]=new Array(moduleCount);for(var col=0;col<moduleCount;col+=1)modules[row][col]=null}return modules}(_moduleCount),setupPositionProbePattern(0,0),setupPositionProbePattern(_moduleCount-7,0),setupPositionProbePattern(0,_moduleCount-7),setupPositionAdjustPattern(),setupTimingPattern(),setupTypeInfo(test,maskPattern),_typeNumber>=7&&setupTypeNumber(test),null==_dataCache&&(_dataCache=createData(_typeNumber,_errorCorrectLevel,_dataList)),mapData(_dataCache,maskPattern)},setupPositionProbePattern=function(row,col){for(var r=-1;r<=7;r+=1)if(!(row+r<=-1||_moduleCount<=row+r))for(var c=-1;c<=7;c+=1)col+c<=-1||_moduleCount<=col+c||(_modules[row+r][col+c]=0<=r&&r<=6&&(0==c||6==c)||0<=c&&c<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=c&&c<=4)},getBestMaskPattern=function(){for(var minLostPoint=0,pattern=0,i=0;i<8;i+=1){makeImpl(!0,i);var lostPoint=QRUtil.getLostPoint(_this);(0==i||minLostPoint>lostPoint)&&(minLostPoint=lostPoint,pattern=i)}return pattern},setupTimingPattern=function(){for(var r=8;r<_moduleCount-8;r+=1)null==_modules[r][6]&&(_modules[r][6]=r%2==0);for(var c=8;c<_moduleCount-8;c+=1)null==_modules[6][c]&&(_modules[6][c]=c%2==0)},setupPositionAdjustPattern=function(){for(var pos=QRUtil.getPatternPosition(_typeNumber),i=0;i<pos.length;i+=1)for(var j=0;j<pos.length;j+=1){var row=pos[i],col=pos[j];if(null==_modules[row][col])for(var r=-2;r<=2;r+=1)for(var c=-2;c<=2;c+=1)_modules[row+r][col+c]=-2==r||2==r||-2==c||2==c||0==r&&0==c}},setupTypeNumber=function(test){for(var bits=QRUtil.getBCHTypeNumber(_typeNumber),i=0;i<18;i+=1){var mod=!test&&1==(bits>>i&1);_modules[Math.floor(i/3)][i%3+_moduleCount-8-3]=mod}for(var i=0;i<18;i+=1){var mod=!test&&1==(bits>>i&1);_modules[i%3+_moduleCount-8-3][Math.floor(i/3)]=mod}},setupTypeInfo=function(test,maskPattern){for(var data=_errorCorrectLevel<<3|maskPattern,bits=QRUtil.getBCHTypeInfo(data),i=0;i<15;i+=1){var mod=!test&&1==(bits>>i&1);i<6?_modules[i][8]=mod:i<8?_modules[i+1][8]=mod:_modules[_moduleCount-15+i][8]=mod}for(var i=0;i<15;i+=1){var mod=!test&&1==(bits>>i&1);i<8?_modules[8][_moduleCount-i-1]=mod:i<9?_modules[8][15-i-1+1]=mod:_modules[8][15-i-1]=mod}_modules[_moduleCount-8][8]=!test},mapData=function(data,maskPattern){for(var inc=-1,row=_moduleCount-1,bitIndex=7,byteIndex=0,maskFunc=QRUtil.getMaskFunction(maskPattern),col=_moduleCount-1;col>0;col-=2)for(6==col&&(col-=1);;){for(var c=0;c<2;c+=1)if(null==_modules[row][col-c]){var dark=!1;byteIndex<data.length&&(dark=1==(data[byteIndex]>>>bitIndex&1));var mask=maskFunc(row,col-c);mask&&(dark=!dark),_modules[row][col-c]=dark,bitIndex-=1,-1==bitIndex&&(byteIndex+=1,bitIndex=7)}if((row+=inc)<0||_moduleCount<=row){row-=inc,inc=-inc;break}}},createBytes=function(buffer,rsBlocks){for(var offset=0,maxDcCount=0,maxEcCount=0,dcdata=new Array(rsBlocks.length),ecdata=new Array(rsBlocks.length),r=0;r<rsBlocks.length;r+=1){var dcCount=rsBlocks[r].dataCount,ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount),maxEcCount=Math.max(maxEcCount,ecCount),dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i+=1)dcdata[r][i]=255&buffer.getBuffer()[i+offset];offset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount),rawPoly=qrPolynomial(dcdata[r],rsPoly.getLength()-1),modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i+=1){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=modIndex>=0?modPoly.getAt(modIndex):0}}for(var totalCodeCount=0,i=0;i<rsBlocks.length;i+=1)totalCodeCount+=rsBlocks[i].totalCount;for(var data=new Array(totalCodeCount),index=0,i=0;i<maxDcCount;i+=1)for(var r=0;r<rsBlocks.length;r+=1)i<dcdata[r].length&&(data[index]=dcdata[r][i],index+=1);for(var i=0;i<maxEcCount;i+=1)for(var r=0;r<rsBlocks.length;r+=1)i<ecdata[r].length&&(data[index]=ecdata[r][i],index+=1);return data},createData=function(typeNumber,errorCorrectLevel,dataList){for(var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel),buffer=qrBitBuffer(),i=0;i<dataList.length;i+=1){var data=dataList[i];buffer.put(data.getMode(),4),buffer.put(data.getLength(),QRUtil.getLengthInBits(data.getMode(),typeNumber)),data.write(buffer)}for(var totalDataCount=0,i=0;i<rsBlocks.length;i+=1)totalDataCount+=rsBlocks[i].dataCount;if(buffer.getLengthInBits()>8*totalDataCount)throw new Error("code length overflow. ("+buffer.getLengthInBits()+">"+8*totalDataCount+")");for(buffer.getLengthInBits()+4<=8*totalDataCount&&buffer.put(0,4);buffer.getLengthInBits()%8!=0;)buffer.putBit(!1);for(;;){if(buffer.getLengthInBits()>=8*totalDataCount)break;if(buffer.put(236,8),buffer.getLengthInBits()>=8*totalDataCount)break;buffer.put(17,8)}return createBytes(buffer,rsBlocks)};return _this.addData=function(data){var newData=qr8BitByte(data);_dataList.push(newData),_dataCache=null},_this.isDark=function(row,col){if(row<0||_moduleCount<=row||col<0||_moduleCount<=col)throw new Error(row+","+col);return _modules[row][col]},_this.getModuleCount=function(){return _moduleCount},_this.make=function(){makeImpl(!1,getBestMaskPattern())},_this.createTableTag=function(cellSize,margin){cellSize=cellSize||2,margin=void 0===margin?4*cellSize:margin;var qrHtml="";qrHtml+='<table style="',qrHtml+=" border-width: 0px; border-style: none;",qrHtml+=" border-collapse: collapse;",qrHtml+=" padding: 0px; margin: "+margin+"px;",qrHtml+='">',qrHtml+="<tbody>";for(var r=0;r<_this.getModuleCount();r+=1){qrHtml+="<tr>";for(var c=0;c<_this.getModuleCount();c+=1)qrHtml+='<td style="',qrHtml+=" border-width: 0px; border-style: none;",qrHtml+=" border-collapse: collapse;",qrHtml+=" padding: 0px; margin: 0px;",qrHtml+=" width: "+cellSize+"px;",qrHtml+=" height: "+cellSize+"px;",qrHtml+=" background-color: ",qrHtml+=_this.isDark(r,c)?"#000000":"#ffffff",qrHtml+=";",qrHtml+='"/>';qrHtml+="</tr>"}return qrHtml+="</tbody>",qrHtml+="</table>"},_this.createSvgTag=function(cellSize,margin){cellSize=cellSize||2,margin=void 0===margin?4*cellSize:margin;var c,mc,r,mr,rect,size=_this.getModuleCount()*cellSize+2*margin,qrSvg="";for(rect="l"+cellSize+",0 0,"+cellSize+" -"+cellSize+",0 0,-"+cellSize+"z ",qrSvg+="<svg",qrSvg+=' width="'+size+'px"',qrSvg+=' height="'+size+'px"',qrSvg+=' xmlns="http://www.w3.org/2000/svg"',qrSvg+=">",qrSvg+='<path d="',r=0;r<_this.getModuleCount();r+=1)for(mr=r*cellSize+margin,c=0;c<_this.getModuleCount();c+=1)_this.isDark(r,c)&&(mc=c*cellSize+margin,qrSvg+="M"+mc+","+mr+rect);return qrSvg+='" stroke="transparent" fill="black"/>',qrSvg+="</svg>"},_this.createImgTag=function(cellSize,margin){cellSize=cellSize||2,margin=void 0===margin?4*cellSize:margin;var size=_this.getModuleCount()*cellSize+2*margin,min=margin,max=size-margin;return createImgTag(size,size,function(x,y){if(min<=x&&x<max&&min<=y&&y<max){var c=Math.floor((x-min)/cellSize),r=Math.floor((y-min)/cellSize);return _this.isDark(r,c)?0:1}return 1})},_this};qrcode.stringToBytes=function(s){for(var bytes=new Array,i=0;i<s.length;i+=1){var c=s.charCodeAt(i);bytes.push(255&c)}return bytes},qrcode.createStringToBytes=function(unicodeData,numChars){var unicodeMap=function(){for(var bin=base64DecodeInputStream(unicodeData),read=function(){var b=bin.read();if(-1==b)throw new Error;return b},count=0,unicodeMap={};;){var b0=bin.read();if(-1==b0)break;var b1=read(),b2=read(),b3=read(),k=String.fromCharCode(b0<<8|b1),v=b2<<8|b3;unicodeMap[k]=v,count+=1}if(count!=numChars)throw new Error(count+" != "+numChars);return unicodeMap}(),unknownChar="?".charCodeAt(0);return function(s){for(var bytes=new Array,i=0;i<s.length;i+=1){var c=s.charCodeAt(i);if(c<128)bytes.push(c);else{var b=unicodeMap[s.charAt(i)];"number"==typeof b?(255&b)==b?bytes.push(b):(bytes.push(b>>>8),bytes.push(255&b)):bytes.push(unknownChar)}}return bytes}};var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRUtil=function(){var PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],_this={},getBCHDigit=function(data){for(var digit=0;0!=data;)digit+=1,data>>>=1;return digit};return _this.getBCHTypeInfo=function(data){for(var d=data<<10;getBCHDigit(d)-getBCHDigit(1335)>=0;)d^=1335<<getBCHDigit(d)-getBCHDigit(1335);return 21522^(data<<10|d)},_this.getBCHTypeNumber=function(data){for(var d=data<<12;getBCHDigit(d)-getBCHDigit(7973)>=0;)d^=7973<<getBCHDigit(d)-getBCHDigit(7973);return data<<12|d},_this.getPatternPosition=function(typeNumber){return PATTERN_POSITION_TABLE[typeNumber-1]},_this.getMaskFunction=function(maskPattern){switch(maskPattern){case QRMaskPattern.PATTERN000:return function(i,j){return(i+j)%2==0};case QRMaskPattern.PATTERN001:return function(i,j){return i%2==0};case QRMaskPattern.PATTERN010:return function(i,j){return j%3==0};case QRMaskPattern.PATTERN011:return function(i,j){return(i+j)%3==0};case QRMaskPattern.PATTERN100:return function(i,j){return(Math.floor(i/2)+Math.floor(j/3))%2==0};case QRMaskPattern.PATTERN101:return function(i,j){return i*j%2+i*j%3==0};case QRMaskPattern.PATTERN110:return function(i,j){return(i*j%2+i*j%3)%2==0};case QRMaskPattern.PATTERN111:return function(i,j){return(i*j%3+(i+j)%2)%2==0};default:throw new Error("bad maskPattern:"+maskPattern)}},_this.getErrorCorrectPolynomial=function(errorCorrectLength){for(var a=qrPolynomial([1],0),i=0;i<errorCorrectLength;i+=1)a=a.multiply(qrPolynomial([1,QRMath.gexp(i)],0));return a},_this.getLengthInBits=function(mode,type){if(1<=type&&type<10)switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+mode)}else if(type<27)switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+mode)}else{if(!(type<41))throw new Error("type:"+type);switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+mode)}}},_this.getLostPoint=function(qrcode){for(var moduleCount=qrcode.getModuleCount(),lostPoint=0,row=0;row<moduleCount;row+=1)for(var col=0;col<moduleCount;col+=1){for(var sameCount=0,dark=qrcode.isDark(row,col),r=-1;r<=1;r+=1)if(!(row+r<0||moduleCount<=row+r))for(var c=-1;c<=1;c+=1)col+c<0||moduleCount<=col+c||0==r&&0==c||dark==qrcode.isDark(row+r,col+c)&&(sameCount+=1);sameCount>5&&(lostPoint+=3+sameCount-5)}for(var row=0;row<moduleCount-1;row+=1)for(var col=0;col<moduleCount-1;col+=1){var count=0;qrcode.isDark(row,col)&&(count+=1),qrcode.isDark(row+1,col)&&(count+=1),qrcode.isDark(row,col+1)&&(count+=1),qrcode.isDark(row+1,col+1)&&(count+=1),0!=count&&4!=count||(lostPoint+=3)}for(var row=0;row<moduleCount;row+=1)for(var col=0;col<moduleCount-6;col+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row,col+1)&&qrcode.isDark(row,col+2)&&qrcode.isDark(row,col+3)&&qrcode.isDark(row,col+4)&&!qrcode.isDark(row,col+5)&&qrcode.isDark(row,col+6)&&(lostPoint+=40);for(var col=0;col<moduleCount;col+=1)for(var row=0;row<moduleCount-6;row+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row+1,col)&&qrcode.isDark(row+2,col)&&qrcode.isDark(row+3,col)&&qrcode.isDark(row+4,col)&&!qrcode.isDark(row+5,col)&&qrcode.isDark(row+6,col)&&(lostPoint+=40);for(var darkCount=0,col=0;col<moduleCount;col+=1)for(var row=0;row<moduleCount;row+=1)qrcode.isDark(row,col)&&(darkCount+=1);return lostPoint+=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5*10},_this}(),QRMath=function(){for(var EXP_TABLE=new Array(256),LOG_TABLE=new Array(256),i=0;i<8;i+=1)EXP_TABLE[i]=1<<i;for(var i=8;i<256;i+=1)EXP_TABLE[i]=EXP_TABLE[i-4]^EXP_TABLE[i-5]^EXP_TABLE[i-6]^EXP_TABLE[i-8];for(var i=0;i<255;i+=1)LOG_TABLE[EXP_TABLE[i]]=i;var _this={};return _this.glog=function(n){if(n<1)throw new Error("glog("+n+")");return LOG_TABLE[n]},_this.gexp=function(n){for(;n<0;)n+=255;for(;n>=256;)n-=255;return EXP_TABLE[n]},_this}(),QRRSBlock=function(){var RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],qrRSBlock=function(totalCount,dataCount){var _this={};return _this.totalCount=totalCount,_this.dataCount=dataCount,_this},_this={},getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return RS_BLOCK_TABLE[4*(typeNumber-1)+0];case QRErrorCorrectLevel.M:return RS_BLOCK_TABLE[4*(typeNumber-1)+1];case QRErrorCorrectLevel.Q:return RS_BLOCK_TABLE[4*(typeNumber-1)+2];case QRErrorCorrectLevel.H:return RS_BLOCK_TABLE[4*(typeNumber-1)+3];default:return}};return _this.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=getRsBlockTable(typeNumber,errorCorrectLevel);if(void 0===rsBlock)throw new Error("bad rs block @ typeNumber:"+typeNumber+"/errorCorrectLevel:"+errorCorrectLevel);for(var length=rsBlock.length/3,list=new Array,i=0;i<length;i+=1)for(var count=rsBlock[3*i+0],totalCount=rsBlock[3*i+1],dataCount=rsBlock[3*i+2],j=0;j<count;j+=1)list.push(qrRSBlock(totalCount,dataCount));return list},_this}(),qrBitBuffer=function(){var _buffer=new Array,_length=0,_this={};return _this.getBuffer=function(){return _buffer},_this.getAt=function(index){var bufIndex=Math.floor(index/8);return 1==(_buffer[bufIndex]>>>7-index%8&1)},_this.put=function(num,length){for(var i=0;i<length;i+=1)_this.putBit(1==(num>>>length-i-1&1))},_this.getLengthInBits=function(){return _length},_this.putBit=function(bit){var bufIndex=Math.floor(_length/8);_buffer.length<=bufIndex&&_buffer.push(0),bit&&(_buffer[bufIndex]|=128>>>_length%8),_length+=1},_this},qr8BitByte=function(data){var _mode=QRMode.MODE_8BIT_BYTE,_bytes=qrcode.stringToBytes(data),_this={};return _this.getMode=function(){return _mode},_this.getLength=function(buffer){return _bytes.length},_this.write=function(buffer){for(var i=0;i<_bytes.length;i+=1)buffer.put(_bytes[i],8)},_this},byteArrayOutputStream=function(){var _bytes=new Array,_this={};return _this.writeByte=function(b){_bytes.push(255&b)},_this.writeShort=function(i){_this.writeByte(i),_this.writeByte(i>>>8)},_this.writeBytes=function(b,off,len){off=off||0,len=len||b.length;for(var i=0;i<len;i+=1)_this.writeByte(b[i+off])},_this.writeString=function(s){for(var i=0;i<s.length;i+=1)_this.writeByte(s.charCodeAt(i))},_this.toByteArray=function(){return _bytes},_this.toString=function(){var s="";s+="[";for(var i=0;i<_bytes.length;i+=1)i>0&&(s+=","),s+=_bytes[i];return s+="]"},_this},base64EncodeOutputStream=function(){var _buffer=0,_buflen=0,_length=0,_base64="",_this={},writeEncoded=function(b){_base64+=String.fromCharCode(encode(63&b))},encode=function(n){if(n<0);else{if(n<26)return 65+n;if(n<52)return n-26+97;if(n<62)return n-52+48;if(62==n)return 43;if(63==n)return 47}throw new Error("n:"+n)};return _this.writeByte=function(n){for(_buffer=_buffer<<8|255&n,_buflen+=8,_length+=1;_buflen>=6;)writeEncoded(_buffer>>>_buflen-6),_buflen-=6},_this.flush=function(){if(_buflen>0&&(writeEncoded(_buffer<<6-_buflen),_buffer=0,_buflen=0),_length%3!=0)for(var padlen=3-_length%3,i=0;i<padlen;i+=1)_base64+="="},_this.toString=function(){return _base64},_this},base64DecodeInputStream=function(str){var _str=str,_pos=0,_buffer=0,_buflen=0,_this={};_this.read=function(){for(;_buflen<8;){if(_pos>=_str.length){if(0==_buflen)return-1;throw new Error("unexpected end of file./"+_buflen)}var c=_str.charAt(_pos);if(_pos+=1,"="==c)return _buflen=0,-1;c.match(/^\s$/)||(_buffer=_buffer<<6|decode(c.charCodeAt(0)),_buflen+=6)}var n=_buffer>>>_buflen-8&255;return _buflen-=8,n};var decode=function(c){if(65<=c&&c<=90)return c-65;if(97<=c&&c<=122)return c-97+26;if(48<=c&&c<=57)return c-48+52;if(43==c)return 62;if(47==c)return 63;throw new Error("c:"+c)};return _this},gifImage=function(width,height){var _width=width,_height=height,_data=new Array(width*height),_this={};_this.setPixel=function(x,y,pixel){_data[y*_width+x]=pixel},_this.write=function(out){out.writeString("GIF87a"),out.writeShort(_width),out.writeShort(_height),out.writeByte(128),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(0),out.writeByte(255),out.writeByte(255),out.writeByte(255),out.writeString(","),out.writeShort(0),out.writeShort(0),out.writeShort(_width),out.writeShort(_height),out.writeByte(0);var raster=getLZWRaster(2);out.writeByte(2);for(var offset=0;raster.length-offset>255;)out.writeByte(255),out.writeBytes(raster,offset,255),offset+=255;out.writeByte(raster.length-offset),out.writeBytes(raster,offset,raster.length-offset),out.writeByte(0),out.writeString(";")};var bitOutputStream=function(out){var _out=out,_bitLength=0,_bitBuffer=0,_this={};return _this.write=function(data,length){if(data>>>length!=0)throw new Error("length over");for(;_bitLength+length>=8;)_out.writeByte(255&(data<<_bitLength|_bitBuffer)),length-=8-_bitLength,data>>>=8-_bitLength,_bitBuffer=0,_bitLength=0;_bitBuffer|=data<<_bitLength,_bitLength+=length},_this.flush=function(){_bitLength>0&&_out.writeByte(_bitBuffer)},_this},getLZWRaster=function(lzwMinCodeSize){for(var clearCode=1<<lzwMinCodeSize,endCode=1+(1<<lzwMinCodeSize),bitLength=lzwMinCodeSize+1,table=lzwTable(),i=0;i<clearCode;i+=1)table.add(String.fromCharCode(i));table.add(String.fromCharCode(clearCode)),table.add(String.fromCharCode(endCode));var byteOut=byteArrayOutputStream(),bitOut=bitOutputStream(byteOut);bitOut.write(clearCode,bitLength);var dataIndex=0,s=String.fromCharCode(_data[dataIndex]);for(dataIndex+=1;dataIndex<_data.length;){var c=String.fromCharCode(_data[dataIndex]);dataIndex+=1,table.contains(s+c)?s+=c:(bitOut.write(table.indexOf(s),bitLength),table.size()<4095&&(table.size()==1<<bitLength&&(bitLength+=1),table.add(s+c)),s=c)}return bitOut.write(table.indexOf(s),bitLength),bitOut.write(endCode,bitLength),bitOut.flush(),byteOut.toByteArray()},lzwTable=function(){var _map={},_size=0,_this={};return _this.add=function(key){if(_this.contains(key))throw new Error("dup key:"+key);_map[key]=_size,_size+=1},_this.size=function(){return _size},_this.indexOf=function(key){return _map[key]},_this.contains=function(key){return void 0!==_map[key]},_this};return _this},createImgTag=function(width,height,getPixel,alt){for(var gif=gifImage(width,height),y=0;y<height;y+=1)for(var x=0;x<width;x+=1)gif.setPixel(x,y,getPixel(x,y));var b=byteArrayOutputStream();gif.write(b);for(var base64=base64EncodeOutputStream(),bytes=b.toByteArray(),i=0;i<bytes.length;i+=1)base64.writeByte(bytes[i]);base64.flush();var img="";return img+="<img",img+=' src="',img+="data:image/gif;base64,",img+=base64,img+='"',img+=' width="',img+=width,img+='"',img+=' height="',img+=height,img+='"',alt&&(img+=' alt="',img+=alt,img+='"'),img+="/>"};return qrcode}();!function(factory){"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports&&(module.exports=factory())}(function(){return qrcode}),function(qrcode){qrcode.stringToBytes=function(s){return function(str){for(var utf8=[],i=0;i<str.length;i++){var charcode=str.charCodeAt(i);charcode<128?utf8.push(charcode):charcode<2048?utf8.push(192|charcode>>6,128|63&charcode):charcode<55296||charcode>=57344?utf8.push(224|charcode>>12,128|charcode>>6&63,128|63&charcode):(i++,charcode=65536+((1023&charcode)<<10|1023&str.charCodeAt(i)),utf8.push(240|charcode>>18,128|charcode>>12&63,128|charcode>>6&63,128|63&charcode))}return utf8}(s)}}(qrcode),angular.module("monospaced.qrcode",[]).directive("qrcode",["$window",function($window){var canvas2D=!!$window.CanvasRenderingContext2D,levels={L:"Low",M:"Medium",Q:"Quartile",H:"High"},draw=function(context,qr,modules,tile,color){for(var row=0;row<modules;row++)for(var col=0;col<modules;col++){var w=Math.ceil((col+1)*tile)-Math.floor(col*tile),h=Math.ceil((row+1)*tile)-Math.floor(row*tile);context.fillStyle=qr.isDark(row,col)?color.foreground:color.background,context.fillRect(Math.round(col*tile),Math.round(row*tile),w,h)}};return{restrict:"E",template:'<canvas class="qrcode"></canvas>',link:function(scope,element,attrs){var error,version,errorCorrectionLevel,data,size,modules,tile,qr,$img,domElement=element[0],$canvas=element.find("canvas"),canvas=$canvas[0],context=canvas2D?canvas.getContext("2d"):null,download="download"in attrs,href=attrs.href,link=download||href?document.createElement("a"):"",trim=/^\s+|\s+$/g,color={foreground:"#000",background:"#fff"},setColor=function(value){color.foreground=value||color.foreground},setBackground=function(value){color.background=value||color.background},setVersion=function(value){version=Math.max(1,Math.min(parseInt(value,10),40))||5},setErrorCorrectionLevel=function(value){errorCorrectionLevel=value in levels?value:"M"},setData=function(value){if(value){data=value.replace(trim,""),qr=qrcode(version,errorCorrectionLevel),qr.addData(data);try{qr.make()}catch(e){return void(error=e.message)}error=!1,modules=qr.getModuleCount()}},setSize=function(value){size=parseInt(value,10)||2*modules,tile=size/modules,canvas.width=canvas.height=size},render=function(){if(qr){if(error)return link&&(link.removeAttribute("download"),link.title="",link.href="#_"),canvas2D||(domElement.innerHTML='<img src width="'+size+'"height="'+size+'"class="qrcode">'),void scope.$emit("qrcode:error",error);if(download&&(domElement.download="qrcode.png",domElement.title="Download QR code"),canvas2D){if(draw(context,qr,modules,tile,color),download)return void(domElement.href=canvas.toDataURL("image/png"))}else if(domElement.innerHTML=qr.createImgTag(tile,0),$img=element.find("img"),$img.addClass("qrcode"),download)return void(domElement.href=$img[0].src);href&&(domElement.href=href)}};link&&(link.className="qrcode-link",$canvas.wrap(link),domElement=domElement.firstChild),setColor(attrs.color),setBackground(attrs.background),setVersion(attrs.version),setErrorCorrectionLevel(attrs.errorCorrectionLevel),setSize(attrs.size),attrs.$observe("version",function(value){value&&(setVersion(value),setData(data),setSize(size),render())}),attrs.$observe("errorCorrectionLevel",function(value){value&&(setErrorCorrectionLevel(value),setData(data),setSize(size),render())}),attrs.$observe("data",function(value){value&&(setData(value),setSize(size),render())}),attrs.$observe("size",function(value){value&&(setSize(value),render())}),attrs.$observe("color",function(value){value&&(setColor(value),render())}),attrs.$observe("background",function(value){value&&(setBackground(value),render())}),attrs.$observe("href",function(value){value&&(href=value,render())})}}}]),angular.module("owsWalletPluginClient.directives").directive("hideTabs",["$rootScope",function($rootScope){return{link:function(scope,elem,attrs,ctrl){scope.$on("$ionicView.beforeEnter",function(event,data){attrs.hideTabs&&"true"!=attrs.hideTabs?$rootScope.hideTabs="":$rootScope.hideTabs="tabs-item-hide"})}}}]),angular.module("owsWalletPluginClient.directives").directive("owsCollapsible",["$rootScope","$timeout",function($rootScope,$timeout){return{restrict:"E",transclude:{header:"owsCollapsibleHeader",body:"owsCollapsibleBody"},scope:{maxHeight:"@",minHeight:"@",topStart:"@",topEnd:"@",model:"="},controller:"OWSCollapsibleCtrl",template:'  <div id="ows-collapsible" class="view-content has-header">    \x3c!-- Header --\x3e    <div class="head-wrapper ng-hide" ng-show="headerIsCollapsible">\t\t<div class="head-content" ng-style="{\'height\': collapsibleItemHeight}"\t\t  ng-class="{\'collapsible\': headerIsCollapsible, \'is-collapsing\': isCollapsing}">      <div ng-transclude="header"></div>    </div>      </div>    <ion-content delegate-handle="owsCollapsibleScroll" on-scroll="getScrollPosition()"      ng-style="{\'margin-top\': contentMargin, \'height\': visibleContentHeight}"      ng-class="{\'collapsible\': headerIsCollapsible}" class="ion-content-ows-collapsible">      <div class="content-wrapper" ng-style="{\'transform\': contentTransform, \'padding-bottom\': contentPaddingBottom}">        \x3c!-- --\x3e        \x3c!-- --\x3e        \x3c!-- --\x3e        \x3c!-- Start header duplicate (for Android compatibility) --\x3e        <div class="head-wrapper ng-hide" ng-show="!headerIsCollapsible">\t\t<div class="head-content" ng-style="{\'height\': collapsibleItemHeight}"\t\t  ng-class="{\'collapsible\': headerIsCollapsible, \'is-collapsing\': isCollapsing}">      <div ng-transclude="header"></div>    </div>          </div>        \x3c!-- End header duplicate (for Android compatibility) --\x3e        \x3c!-- --\x3e        \x3c!-- --\x3e        <div ng-transclude="body"></div>      </div>    </ion-content>  </div>\t',link:function(scope,element,attrs){angular.extend(scope.model,{reset:function(){scope.reset()}}),scope.$watch("maxHeight",function(height){scope.headerMaxHeight=parseInt(height)||scope.headerMaxHeight,scope.contentMargin=scope.headerMaxHeight+"px",scope.collapsibleItemHeight=scope.headerMaxHeight+"px"}),scope.$watch("minHeight",function(height){scope.headerMinHeight=parseInt(height)||scope.headerMinHeight}),scope.$watch("topStart",function(top){scope.headerTop=parseInt(top)||scope.headerTop}),scope.$watch("topEnd",function(top){scope.headerTopFinal=parseInt(top)||scope.headerTopFinal})}}}]),angular.module("owsWalletPluginClient.controllers").controller("OWSCollapsibleCtrl",["$rootScope","$scope","$window","$ionicScrollDelegate","$timeout",function($rootScope,$scope,$window,$ionicScrollDelegate,$timeout){function refreshHeader(scrollPos){if($scope.headerIsCollapsible){void 0==scrollPos&&void 0==lastScrollPos&&(lastScrollPos=0),void 0==scrollPos&&(scrollPos=lastScrollPos),lastScrollPos=scrollPos;var collapsibleItemHeight=$scope.headerMaxHeight-scrollPos;collapsibleItemHeight<$scope.headerMinHeight&&(collapsibleItemHeight=$scope.headerMinHeight),collapsibleItemHeight>$scope.headerMaxHeight&&(collapsibleItemHeight=$scope.headerMaxHeight),$scope.collapsibleItemPercent=(collapsibleItemHeight-$scope.headerMinHeight)/($scope.headerMaxHeight-$scope.headerMinHeight);var collapsibleItemContentScale=HEADER_CONTENT_MIN_SCALE+$scope.collapsibleItemPercent*(1-HEADER_CONTENT_MIN_SCALE),contentMargin=collapsibleItemHeight,headerTop=$scope.headerTopFinal-$scope.collapsibleItemPercent*($scope.headerTopFinal-$scope.headerTop);$scope.elementOpacity=$scope.collapsibleItemPercent,$window.requestAnimationFrame(function(){var tabBarOffset=""==$rootScope.hideTabs?TAB_BAR_HEIGHT:0;$scope.collapsibleItemHeight=collapsibleItemHeight+"px",$scope.visibleContentHeight=$window.screen.height-CONTENT_INSET_TOP-contentMargin-tabBarOffset+"px",$scope.contentMargin=contentMargin+"px",$scope.contentTransform="translateY("+($scope.headerMaxHeight-collapsibleItemHeight)+"px)",$scope.collapsibleItemScale="scale3d("+collapsibleItemContentScale+","+collapsibleItemContentScale+","+collapsibleItemContentScale+") translateY("+headerTop+"px)",$scope.isCollapsing=collapsibleItemHeight<$scope.headerMaxHeight,$scope.$digest(),refreshModel(),$rootScope.$emit("owsCollapsibleChange",{percentage:$scope.collapsibleItemPercent})})}}function refreshModel(){$scope.model&&($scope.model.percentage=$scope.collapsibleItemPercent,$scope.model.headerHeight=$scope.collapsibleItemHeight,$scope.model.bodyHeight=parseInt($scope.visibleContentHeight),$scope.model.scale=$scope.collapsibleItemScale,
$scope.model.opacity=$scope.elementOpacity)}var CONTENT_INSET_TOP=owswallet.Plugin.safeAreaInsets().top+44,HEADER_CONTENT_MIN_SCALE=(owswallet.Plugin.safeAreaInsets().bottom,.5),TAB_BAR_HEIGHT=49;$scope.headerMaxHeight=80,$scope.headerMinHeight=44,$scope.headerTop=20,$scope.headerTopFinal=15,$scope.contentMargin=$scope.headerMaxHeight+"px",$scope.collapsibleItemHeight=$scope.headerMaxHeight+"px";var lastScrollPos=($window.screen.height,$scope.headerMinHeight,void 0);$scope.headerIsCollapsible=!owswallet.Plugin.isAndroid(),$scope.getScrollPosition=function(){refreshHeader($ionicScrollDelegate.$getByHandle("owsCollapsibleScroll").getScrollPosition().top)},$scope.reset=function(){refreshHeader(0)}}]),angular.module("owsWalletPluginClient.directives").directive("owsKeypad",function(){return{restrict:"E",scope:{buttonDelSrc:"@",config:"@"},controller:"OWSKeypadCtrl",template:'\t\t<div id="ows-keypad">\t\t\t<div class="keypad">\t\t\t  <div class="row">\t\t\t    <div class="col digit" ng-click="pushDigit(\'1\')">1</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'2\')">2</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'3\')">3</div>\t\t\t  </div>\t\t\t  <div class="row">\t\t\t    <div class="col digit" ng-click="pushDigit(\'4\')">4</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'5\')">5</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'6\')">6</div>\t\t\t  </div>\t\t\t  <div class="row">\t\t\t    <div class="col digit" ng-click="pushDigit(\'7\')">7</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'8\')">8</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'9\')">9</div>\t\t\t  </div>\t\t\t  <div class="row">\t\t\t    <div class="col digit" ng-click="pushDigit(\'.\')">.</div>\t\t\t    <div class="col digit" ng-click="pushDigit(\'0\')">0</div>\t\t\t    <div class="col digit" ng-click="removeDigit()">\t\t\t      <img svg ng-src="{{buttonDelSrc}}">\t\t\t    </div>\t\t\t  </div>\t\t\t</div>\t\t</div>\t',link:function(scope,element,attrs){scope.$watch("config",function(value){scope.config=value})}}}),angular.module("owsWalletPluginClient.controllers").controller("OWSKeypadCtrl",["$rootScope","$scope","$timeout","$log","lodash","stringUtils","owsWalletPluginClient.api.BN","owsWalletPluginClient.api.Constants",function($rootScope,$scope,$timeout,$log,lodash,stringUtils,BN,Constants){function clearCurrencyCache(){currencyToggleCache={}}function update(){var formatOpts={language:language,isCrypto:Constants.isCryptoCurrency(currencies[currencyIndex]),noZeroDecimals:!0};value=stringUtils.format(value.entered,currencies[currencyIndex],formatOpts);var valueHtml=value.entered_u_p.sign+value.entered_u_p.symbol+value.entered_u_p.number.slice(0,-1)+'<span class="'+(placeholder?"placeholder":"")+'">'+value.entered_u_p.number.slice(-1)+"</span>"+value.entered_u_p.currency;$timeout(function(){$scope.$apply()}),$rootScope.$emit("Local/KeypadState",{lengthExpressionLimit:lengthExpressionLimit,currency:currencies[currencyIndex],nextCurrency:currencies[currencyIndex+1>=currencies.length?0:currencyIndex+1],nextCurrencyIndex:currencyIndex+1>=currencies.length?0:currencyIndex+1,amount:stringUtils.float(value.entered),amountHtml:valueHtml,placeholder:placeholder})}var usdRates,language="en",lengthExpressionLimit=9,placeholder=!1,value={entered:0},currencies=[],currencyIndex=0,currencyToggleCache={};$scope.$watch("config",function(config,oldConfig){if(config!=oldConfig&&config.length>0){config=JSON.parse(config);var previousCurrencyIndex=currencyIndex;if(language=config.language||language,lengthExpressionLimit=config.lengthExpressionLimit||lengthExpressionLimit,usdRates=config.usdRates||usdRates,currencies=config.currencies||currencies,config.value){if(currencies.indexOf(config.value.currency)<0)return $log.error("Keypad not configured for currency '"+config.value.currency+"'");if(config.value.currency==currencies[currencyIndex])value.entered=config.value.amount;else{var usdValue=BN.div(config.value.amount,usdRates[config.value.currency]);value.entered=BN.multiply(usdValue,usdRates[currencies[currencyIndex]])}clearCurrencyCache()}else if("number"!=typeof config.currencyIndex&&void 0!=config.currencyIndex||(currencyIndex=void 0!=config.currencyIndex?config.currencyIndex:currencyIndex),currencies.length>1){if(!usdRates)return;if(currencyIndex!=previousCurrencyIndex){currencyToggleCache[currencies[previousCurrencyIndex]]={value:value.entered,placeholder:placeholder};var cacheEntry=currencyToggleCache[currencies[currencyIndex]];if(cacheEntry)value.entered=cacheEntry.value,placeholder=cacheEntry.placeholder;else{var usdValue=BN.div(value.entered,usdRates[currencies[previousCurrencyIndex]]);value.entered=BN.multiply(usdValue,usdRates[currencies[currencyIndex]]),placeholder=!1}}}update()}}),$scope.pushDigit=function(digit){var entered=value.entered;if(!("."!=digit&&entered.indexOf(".")<0&&entered.length>=lengthExpressionLimit||entered.indexOf(".")>-1&&"."==digit)){if("0"==entered&&placeholder&&"0"==digit)placeholder=!1;else{if("0"==entered&&!placeholder&&"0"==digit)return;"0"!=entered||placeholder||"."!=digit?"0"==entered&&placeholder&&"."==digit?entered="0.0":"0"==entered&&placeholder?(entered=digit,placeholder=!1):"0"!=entered||placeholder?"0.0"==entered&&placeholder?(entered="0."+digit,placeholder=!1):"."==digit?(entered+=".0",placeholder=!0):placeholder?(entered=entered.slice(0,-1)+digit,placeholder=!1):(entered+=digit,placeholder=!1):entered=digit:(entered="0.0",placeholder=!0)}value.entered=entered,update(),clearCurrencyCache()}},$scope.removeDigit=function(){var entered=value.entered;"0"==entered&&placeholder||("0"!=entered||placeholder?1==entered.length&&placeholder?(entered="0",placeholder=!0):"0.0"==entered&&placeholder?entered="0":".0"==entered.slice(-2)&&placeholder?(entered=entered.slice(0,-2),placeholder=!1):"."!=entered.slice(-2,-1)||placeholder?entered=entered.slice(0,-1)||"0":(entered=entered.slice(0,-1)+"0",placeholder=!0):placeholder=!0,value.entered=entered,update(),clearCurrencyCache())}}]),angular.module("owsWalletPluginClient.directives").directive("owsSessionLog",function(){return{restrict:"E",scope:{},controller:"OWSSessionLogCtrl",template:'\t  <div id="ows-session-log">\t    <div ng-show="filteredLogs.length == 0" translate>\t      No Entries For this log level. Adjust setting in app at Settings > About > Session Log.\t    </div>\t    <ion-list ng-show="filteredLogs.length > 0">\t      <ion-item class="item-text-wrap enable_text_select log-entry">\t        <ul ng-show="filteredLogs.length > 0">\t          <li ng-repeat="l in filteredLogs">\t            <span ng-class="{\'warning\': l.level==\'warn\', \'debug\': l.level==\'debug\', \'info\': l.level==\'info\', \'error\': l.level==\'error\'}">\t              <span class="log-timestamp">[{{l.timestamp}}]</span>\t              <span class="log-level">[{{l.level}}]</span>\t              <span class="log-client" ng-if="!isCordova">[{{pluginName}}]</span>\t              {{l.msg}}\t            </span>\t          </li>\t        </ul>\t      </ion-item>\t    </ion-list>    </div>\t',link:function(scope,element,attrs){}}}),angular.module("owsWalletPluginClient.controllers").controller("OWSSessionLogCtrl",["$scope","$timeout","$window","$ionicScrollDelegate","historicLogService","lodash","gettextCatalog","owsWalletPluginClient.api.Session",function($scope,$timeout,$window,$ionicScrollDelegate,historicLogService,lodash,gettextCatalog,Session){var session=Session.getInstance(),pluginId=session.plugin.header.id+"@"+session.plugin.header.version;$scope.pluginName=session.plugin.header.name+"@"+session.plugin.header.version,$scope.isCordova=owswallet.Plugin.isCordova();var logLevel=session.logLevel,selectedLevel=(historicLogService.getLevels(),historicLogService.getLevel(logLevel));!function(weight){$scope.filteredLogs=historicLogService.get(weight)}(selectedLevel.weight),$timeout(function(){$ionicScrollDelegate.scrollBottom()},200),$scope.prepareLogs=function(){var log=pluginId+" session logs\n Be careful, this could contain sensitive private data.\n\n";return log+=historicLogService.get().map(function(v){return"["+v.timestamp+"]["+v.level+"]"+v.msg}).join("\n")},$scope.sendLogs=function(){var body=$scope.prepareLogs();$window.top.plugins.socialsharing.shareViaEmail(body,pluginId+" session logs",null,null,null,null,function(){},function(){})}}]),angular.module("owsWalletPluginClient.directives").directive("owsTransactions",function(){return{restrict:"E",scope:{listName:"@",transactions:"=",styleIconReceived:"@",styleIconSent:"@",onClick:"@"},controller:"OWSTransactionsCtrl",template:'    <ion-list id="ows-transactions">      <ion-item class="item-divider" ng-class="{\'has-label\': listName}">        {{listName}}      </ion-item>\t\t\t<ion-item class="item-icon-left icon-left-lg" ng-class="{\'has-click\': onClick, \'has-detail\': tx.subtitle}"\t\t\t\tng-repeat="tx in transactions track by $index" ng-click="{{onClick}}(tx)">\t\t\t  \x3c!-- Icon (left side) --\x3e\t\t\t  <i class="icon lg-icon left-icon">\t\t      <div class="tx-icon received" style="{{styleIconReceived}}" ng-if="tx.type == \'received\'"></div>\t\t      <div class="tx-icon sent" style="{{styleIconSent}}" ng-if="tx.type == \'sent\'"></div>\t\t\t  </i>\t\t\t  \x3c!-- Amount (right side) --\x3e\t\t\t  <div class="tx-note">\t\t\t    <span class="tx-amount" ng-class="{\'recent\': tx.type == \'recent\', \'received\': tx.type == \'received\', \'sent\': tx.type == \'sent\'}">\t\t        {{format(tx.amount, tx.currency).localized_u}}\t\t\t    </span>\t\t\t    <div class="tx-time">\t\t\t      <time ng-if="tx.time && createdWithinPastDay(tx.time * 1000)">\t\t\t        {{tx.time * 1000 | amTimeAgo}}\t\t\t      </time>\t\t\t      <time ng-if="tx.time && !createdWithinPastDay(tx.time * 1000)">\t\t\t        {{tx.time * 1000 | amDateFormat:\'MMM D, YYYY\'}}\t\t\t      </time>\t\t\t    </div>\t\t\t  </div>\t\t\t  \x3c!-- Description --\x3e\t\t\t  <div class="tx-description">\t\t      <span ng-if="tx.title" class="tx-title ellipsis">\t\t        {{tx.title}}\t\t      </span>\t        <div ng-if="tx.subtitle" class="tx-subtitle ellipsis">\t        \t{{tx.subtitle}}\t        </div>\t\t      <span ng-if="!tx.title" translate>\t\t\t\t\t\t<span ng-show="tx.type == \'received\'" translate>Received</span>\t\t\t\t\t\t<span ng-show="tx.type == \'sent\'" translate>Sent</span>\t\t      </span>\t\t\t  </div>\t\t\t</ion-item>    </ion-list>\t',link:function(scope,element,attrs){scope.$watch("transactions",function(value){scope.transactions=value})}}}),angular.module("owsWalletPluginClient.controllers").controller("OWSTransactionsCtrl",["$scope","stringUtils",function($scope,stringUtils){$scope.format=stringUtils.format}]),angular.module("owsWalletPluginClient.directives").directive("owsWalletTransactions",function(){return{restrict:"E",scope:{transactions:"=",styleIconConfirming:"@",styleIconReceived:"@",styleIconSent:"@",styleIconMoved:"@",onClick:"@"},controller:"OWSWalletTransactionsCtrl",template:'    <ion-list id="ows-wallet-transactions">\t\t\t<ion-item class="has-click item-icon-left icon-left-lg" ng-repeat="tx in transactions track by $index" ng-click="{{onClick}}(tx)">\t\t\t  \x3c!-- Icon --\x3e\t\t\t  <i class="icon lg-icon left-icon">\t\t\t    <span ng-if="isUnconfirmed(tx)">\t\t\t      <div class="tx-icon confirming" style="{{styleIconConfirming}}"></div>\t\t\t    </span>\t\t\t    <span ng-if="!isUnconfirmed(tx)">\t\t\t      <div class="tx-icon received" style="{{styleIconReceived}}" ng-if="tx.action == \'received\'"></div>\t\t\t      <div class="tx-icon sent" style="{{styleIconSent}}" ng-if="tx.action == \'sent\'"></div>\t\t\t      <div class="tx-icon moved" style="{{styleIconMoved}}" ng-if="tx.action == \'moved\'"></div>\t\t\t    </span>\t\t\t  </i>\t\t\t  \x3c!-- Amount (right side) --\x3e\t\t\t  <div class="tx-detail">\t\t\t    <span ng-class="{\'tx-amount recent\': tx.recent, \'tx-amount received\': tx.action == \'received\', \'tx-amount sent\': tx.action == \'sent\',\t\t\t      \'tx-amount moved\': tx.action == \'moved\'}">\t\t\t      <span ng-if="tx.action == \'sent\'">–</span>\t\t\t      <span ng-if="tx.action == \'invalid\'" translate>\t\t\t        (possible double spend)\t\t\t      </span>\t\t\t      <span ng-if="tx.action != \'invalid\'">\t\t\t        {{tx.amountStr}}\t\t\t      </span>\t\t\t    </span>\t\t\t    <div class="tx-time">\t\t\t      <time ng-if="tx.time && createdWithinPastDay(tx.time * 1000)">\t\t\t        {{tx.time * 1000 | amTimeAgo}}\t\t\t      </time>\t\t\t      <time ng-if="tx.time && !createdWithinPastDay(tx.time * 1000)">\t\t\t        {{tx.time * 1000 | amDateFormat:\'MMM D, YYYY\'}}\t\t\t      </time>\t\t\t    </div>\t\t\t  </div>\t\t\t  \x3c!-- Confirmed --\x3e\t\t\t  <div class="tx-description" ng-if="!isUnconfirmed(tx)">\t\t\t    \x3c!-- Received --\x3e\t\t\t    <div ng-show="tx.action == \'received\'">\t\t\t      <span ng-if="tx.note.body" class="ellipsis">\t\t\t        {{tx.note.body}}\t\t\t      </span>\t\t\t      <span ng-if="!tx.note.body" translate>\t\t\t        Received\t\t\t      </span>\t\t\t      <span ng-if="tx.lowFees || tx.lowAmount">\t\t\t        <i class="ion-alert-circled"></i>\t\t\t      </span>\t\t\t    </div>\t\t\t    \x3c!-- Sent --\x3e\t\t\t    <div ng-show="tx.action == \'sent\'">\t\t\t      <div ng-if="tx.message" class="ellipsis">\t\t\t        {{tx.message}}\t\t\t      </div>\t\t\t      <div ng-if="!tx.message && tx.note.body" class="ellipsis">\t\t\t        {{tx.note.body}}\t\t\t      </div>\t\t\t      <div ng-if="!tx.message && !tx.note.body && addressbook[tx.addressTo]" class="ellipsis">\t\t\t        {{addressbook[tx.addressTo].name || addressbook[tx.addressTo]}}\t\t\t      </div>\t\t\t      <div ng-if="!tx.message && !tx.note.body && !addressbook[tx.addressTo]" translate>\t\t\t        Sent\t\t\t      </div>\t\t\t    </div>\t\t\t    \x3c!-- Moved --\x3e\t\t\t    <div ng-show="tx.action == \'moved\'">\t\t\t      <div ng-if="tx.note.body" class="ellipsis">\t\t\t        {{tx.note.body}}\t\t\t      </div>\t\t\t      <div ng-if="!tx.note.body" translate>\t\t\t        Moved\t\t\t      </div>\t\t\t    </div>\t\t\t    \x3c!-- Invalid --\x3e\t\t\t    <span ng-if="tx.action == \'invalid\'" translate>\t\t\t      Invalid\t\t\t    </span>\t\t\t  </div>\t\t\t  \x3c!-- Unconfirmed --\x3e\t\t\t  <div ng-if="isUnconfirmed(tx)">\t\t\t    <span ng-if="tx.action == \'sent\' || tx.action == \'moved\'" class="ellipsis">\t\t\t      {{addressbook[tx.addressTo].name || addressbook[tx.addressTo] || \'Sending\'|translate}}\t\t\t    </span>\t\t\t    <span ng-if="tx.action == \'received\'" translate>\t\t\t      Receiving\t\t\t    </span>\t\t\t  </div>\t\t\t</ion-item>    </ion-list>\t',link:function(scope,element,attrs){scope.$watch("transactions",function(value){scope.transactions=value})}}}),angular.module("owsWalletPluginClient.controllers").controller("OWSWalletTransactionsCtrl",function(){}),angular.module("owsWalletPluginClient.directives").directive("owsWallets",["gettextCatalog",function(gettextCatalog){return{restrict:"E",scope:{wallets:"=",title:"@",onClick:"="},controller:"OWSWalletsCtrl",template:'    <ion-list id="ows-wallets">      <div class="item item-divider" ng-show="title" translate>        {{title}}      </div>      <a class="item item-icon-left item-icon-right" ng-class="{\'has-detail\': wallet.error}" ng-click="onClick(wallet)"        ng-repeat="wallet in wallets track by wallet.id">        <img svg="fill: {{wallet.color}}" ng-src="img/icon-{{wallet.currency.toLowerCase()}}.svg">        <span class="item-description">\t        <h2>{{wallet.name}}</h2>\t        <div class="item-detail">\t          <p class="error" ng-show="wallet.error" translate>Wallet Error</p>\t        </div>        </span>        <span class="item-note" ng-class="{\'two-lines\': wallet.status.alternativeIsoCode != wallet.currency}">          <h2>            {{wallet.format().balance}}          </h2>          <p ng-if="wallet.status.alternativeIsoCode != wallet.currency">            {{wallet.format().balanceAlternative}}          </p>        </span>        <i class="icon ion-ios-arrow-right"></i>      </a>    </ion-list>\t',link:function(scope,element,attrs){scope.$watch("wallets",function(value){scope.wallets=value})}}}]),angular.module("owsWalletPluginClient.controllers").controller("OWSWalletsCtrl",function(){}),angular.module("owsWalletPluginClient.directives").directive("showTabs",["$rootScope",function($rootScope){return{link:function(scope,elem,attrs,ctrl){scope.$on("$ionicView.enter",function(event,data){attrs.showTabs&&"true"!=attrs.showTabs?$rootScope.hideTabs="tabs-item-hide":$rootScope.hideTabs=""})}}}]),angular.module("owsWalletPluginClient.directives").directive("svg",["$http","$timeout",function($http,$timeout){return{restrict:"A",link:function(scope,element,attrs){function loadSVG(imgUrl){function doLoad(data){svg&&svg.remove(),$timeout(function(){svg=angular.element(data);for(var i=svg.length-1;i>=0;i--)if(svg[i].constructor==SVGSVGElement){svg=angular.element(svg[i]);break}void 0!==imgId&&svg.attr("id",imgId),void 0!==imgClass&&svg.attr("class",imgClass);for(var svgAttrs=[],pairs=attrs.svg.split(";"),i=0;i<pairs.length;i++){var a=pairs[i].split(":");svgAttrs.push({key:a[0],value:a[1]})}for(var elem,groups=svg.find("g"),i=0;i<groups.length;i++){elem=angular.element(groups[i]);for(var j=0;j<svgAttrs.length;j++)elem.attr(svgAttrs[j].key)&&elem.attr(svgAttrs[j].key,svgAttrs[j].value)}svg=svg.removeAttr("xmlns:a"),element.after(svg)})}function blankSVG(){return'            <?xml version="1.0" encoding="UTF-8"?>            <svg width="80px" height="80px" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">              \x3c!-- Generator: sketchtool 47.1 (45422) - http://www.bohemiancoding.com/sketch --\x3e              <title>img/icon-blank</title>              <desc>Created with sketchtool.</desc>              <defs></defs>              <g id="Applet-images" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">                <g id="img/icon-blank">                  <g id="blank"></g>                </g>              </g>            </svg>          '}imgUrl?loadedUrl!=imgUrl&&(loadedUrl=imgUrl,$http.get(imgUrl).success(function(data,status){doLoad(data)})):doLoad(blankSVG)}var loadedUrl,svg,imgId=attrs.id,imgClass=attrs.class,imgUrl=attrs.src||attrs.ngSrc;element.addClass("ng-hide"),loadSVG(imgUrl),scope.$watch(function(){return element.attr("ng-src")},function(imgUrl){loadSVG(imgUrl)}),scope.$on("$destroy",function(){svg&&svg.remove()})}}}]),angular.module("owsWalletPluginClient.filters",[]).filter("orderObjectBy",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),angular.module("owsWalletPluginClient.services").service("externalLinkService",["nodeWebkitService","popupService","gettextCatalog","$window","$log","$timeout",function(nodeWebkitService,popupService,gettextCatalog,$window,$log,$timeout){function restoreHandleOpenURL(old){$timeout(function(){$window.top.handleOpenURL=old},500)}var isNodeWebKit,root={};return owswallet.Plugin.ready(function(){isNodeWebKit=owswallet.Plugin.isNodeWebKit()}),root.open=function(url,optIn,title,message,okText,cancelText){var old=$window.top.handleOpenURL;$window.top.handleOpenURL=function(url){$log.debug("Skip: "+url)},isNodeWebKit?(nodeWebkitService.openExternalLink(url),restoreHandleOpenURL(old)):optIn?popupService.showConfirm(title,message,okText,cancelText,function(res){res&&$window.top.open(url,"_system"),restoreHandleOpenURL(old)}):($window.top.open(url,"_system"),restoreHandleOpenURL(old))},root}]),angular.module("owsWalletPluginClient.services").service("nodeWebkitService",function(){var root={};return root.readFromClipboard=function(){return require("nw.gui").Clipboard.get().get()},root.writeToClipboard=function(text){return require("nw.gui").Clipboard.get().set(text)},root.openExternalLink=function(url){return require("nw.gui").Shell.openExternal(url)},root}),angular.module("owsWalletPluginClient.services").service("popupService",["$log","$ionicPopup","$timeout","$window","gettextCatalog","lodash",function($log,$ionicPopup,$timeout,$window,gettextCatalog,lodash){var isCordova;owswallet.Plugin.ready(function(){isCordova=owswallet.Plugin.isCordova()});var _ionicAlert=function(title,message,cb,okText){cb=cb||function(){},$ionicPopup.alert({title:title,subTitle:message,okType:"button-clear button-primary",okText:okText||gettextCatalog.getString("OK")}).then(cb)},_ionicConfirm=function(title,message,okText,cancelText,cb){cb=cb||function(){},$ionicPopup.confirm({title:title,subTitle:message,cancelText:cancelText,cancelType:"button-clear button-secondary",okText:okText,okType:"button-clear button-primary"}).then(function(res){return cb(res)})},_ionicPrompt=function(title,message,opts,cb){opts=opts||{},cb=cb||function(){},$ionicPopup.prompt({title:title,subTitle:message,cssClass:opts.class,template:'<input ng-model="data.response" type="'+opts.inputType+'" value ="" autocomplete="off" autofocus>',inputPlaceholder:opts.inputPlaceholder,defaultText:opts.defaultText}).then(function(res){return cb(res)})},_cordovaAlert=function(title,message,cb,okText){cb=cb||function(){},title=title||"",okText=okText||gettextCatalog.getString("OK"),$window.top.navigator.notification.alert(message,cb,title,okText)},_cordovaConfirm=function(title,message,okText,cancelText,cb){cb=cb||function(){};var onConfirm=function(buttonIndex){return cb(2==buttonIndex?!0:!1)};okText=okText||gettextCatalog.getString("OK"),cancelText=cancelText||gettextCatalog.getString("Cancel"),title=title||"",$window.top.navigator.notification.confirm(message,onConfirm,title,[cancelText,okText])},_cordovaPrompt=function(title,message,opts,cb){cb=cb||function(){};var onPrompt=function(results){return 1==results.buttonIndex?cb(results.input1):cb()},okText=gettextCatalog.getString("OK"),cancelText=gettextCatalog.getString("Cancel");title=title||"",$window.top.navigator.notification.prompt(message,onPrompt,title,[okText,cancelText],opts.defaultText)};this.showAlert=function(title,message,cb,okText){title=lodash.isEmpty(title)?"":title,message=lodash.isEmpty(message)?"":message;var msg=message&&message.message?message.message:msg;$log.warn(title?title+": "+message:message),isCordova?_cordovaAlert(title,message,cb,okText):_ionicAlert(title,message,cb,okText)},this.showConfirm=function(title,message,okText,cancelText,cb){title=lodash.isEmpty(title)?"":title,message=lodash.isEmpty(message)?"":message,$log.warn(title?title+": "+message:message),isCordova?_cordovaConfirm(title,message,okText,cancelText,cb):_ionicConfirm(title,message,okText,cancelText,cb)},this.showPrompt=function(title,message,opts,cb){title=lodash.isEmpty(title)?"":title,message=lodash.isEmpty(message)?"":message,$log.warn(title?title+": "+message:message),opts=opts||{},isCordova&&!opts.forceHTMLPrompt?_cordovaPrompt(title,message,opts,cb):_ionicPrompt(title,message,opts,cb)}}]);